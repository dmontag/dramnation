<html>
<head>
    <style>
body {
    background: url(bg2.jpg) no-repeat center center fixed; 
    -webkit-background-size: cover;
    -moz-background-size: cover;
    -o-background-size: cover;
    background-size: cover;
}

.heading {
    position: absolute;
    left: 30px;
    top: 80%;
    color: white;
    font-family: "Lucida Console", Monaco, monospace;
}

.heading h1 {
    font-size: 2.5em; 
}

.console {
    position: absolute;
    left: 40%;
    bottom: 0%;
    color: white;
    font-family: "Lucida Console", Monaco, monospace;
    width:55%;
}

#query {
    width: 100%;
}

#result {
    height: 70%;
    width: 100%;
}

.distilleryName {
    color: hotpink;
}

.whiskyName {
    color: gold;
}

    </style>
    <script src="jquery-2.1.1.js"></script>
    <script>
        $(document).ready(function() {
            $("#query").keypress(function (e) {
                if (e.which == '13') {
                    $("#result").html("");
                    var query = $("#query")[0].value;
                    $.post("/app", {query: query}, renderResult);
                }
            });
        });

        function renderResult(result, status, xhr) {
            console.log(result);
            var html;
            if (result.error) {
                html = JSON.stringify(result.error);
            } else if (result.result) {
                var data = result.result.map(function(d) { return {data:d["n"]["_data"]["data"], labels:d["labels(n)"]}; });
                html = data.map(renderItem).join("<br/>");
            }
            $("#result").html(html);
        }

        function renderItem(item) {
            console.log(item);
            var result = "<strong><span class='" + getItemNameClass(item.labels) + "'>" + item.data.displayName + "</span></strong> ";
            delete item.data.name;
            delete item.data.displayName;
            result += Object.keys(item.data).map(function (k) {
                var v = item.data[k];
                return k + ": " + v;
            }).join(", ");
            return result;
        }

        function getItemNameClass(labels) {
            switch(labels[0]) {
                case "Whisky": return "whiskyName";
                case "Distillery": return "distilleryName";
            }
        }
    </script>
</head>
<body>
    <div class="heading">
        <h1>Dramnation</h1>
        <p>
            Sponsored by Glenersta Whisky Society
        </p>
    </div>
    <div class="console">
        <div id="result"></div>
        <input id="query" type="text"/>
        <p>
            Examples:
            <ul>
                <li>list all (whisky|distilleries)</li>
                <li>add distillery &lt;name&gt;</li>
                <li>add whisky &lt;definition&gt;</li>
            </ul>
        </p>
    </div>
</body>
</html>